var B=Object.create;var g=Object.defineProperty;var F=Object.getPrototypeOf;var A=Object.prototype.hasOwnProperty;var R=Object.getOwnPropertyNames;var C=Object.getOwnPropertyDescriptor;var P=e=>g(e,"__esModule",{value:true});var V=(e,s)=>{for(var n in s)g(e,n,{get:s[n],enumerable:true})};var j=(e,s,n)=>{if(s&&typeof s==="object"||typeof s==="function"){for(let r of R(s))if(!A.call(e,r)&&r!=="default")g(e,r,{get:()=>s[r],enumerable:!(n=C(s,r))||n.enumerable})}return e};var S=e=>{if(e&&e.__esModule)return e;return j(P(g(e!=null?B(F(e)):{},"default",{value:e,enumerable:true})),e)};P(exports);V(exports,{IPES_ipv4Regex:()=>x,IPES_ipv6Regex:()=>$,_normalizeFamily:()=>p,address:()=>U,cidr:()=>M,cidrSubnet:()=>q,fromLong:()=>c,fromPrefixLen:()=>E,ipv4Regex:()=>x,ipv6Regex:()=>$,isEqual:()=>O,isLoopback:()=>L,isPrivate:()=>b,isPublic:()=>k,isV4Format:()=>I,isV6Format:()=>v,loopback:()=>y,mask:()=>d,not:()=>z,or:()=>D,subnet:()=>w,toBuffer:()=>a,toLong:()=>_,toString:()=>u});var h=S(require("buffer"));var m=S(require("os"));var x=/^(\d{1,3}\.){3,3}\d{1,3}$/;var $=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function I(e){return x.test(e)}function v(e){return $.test(e)}function a(e,s,n){let r=~~n;let f;if(I(e)){f=s||h.Buffer.alloc(r+4);e.split(/\./g).forEach(t=>{f[r++]=parseInt(t,10)&255})}else if(v(e)){const t=e.split(":",8);let o;for(o=0;o<t.length;o++){const i=I(t[o]);let l;if(i){l=a(t[o]);t[o]=l.slice(0,2).toString("hex")}if(l&&++o<8){t.splice(o,0,l.slice(2,4).toString("hex"))}}if(t[0]===""){while(t.length<8)t.unshift("0")}else if(t[t.length-1]===""){while(t.length<8)t.push("0")}else if(t.length<8){for(o=0;o<t.length&&t[o]!=="";o++);const i=[o,1];for(o=9-t.length;o>0;o--){i.push("0")}t.splice.apply(t,i)}f=s||h.Buffer.alloc(r+16);for(o=0;o<t.length;o++){const i=parseInt(t[o],16);f[r++]=i>>8&255;f[r++]=i&255}}if(!f){throw Error(`Invalid ip address: ${e}`)}return f}function u(e,s,n){const r=~~s;const f=n||e.length-r;const t=[];let o;let i;if(f===4){for(i=0;i<f;i++){t.push(e[r+i])}o=t.join(".")}else if(f===16){for(i=0;i<f;i+=2){t.push(e.readUInt16BE(r+i).toString(16))}o=t.join(":");o=o.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3");o=o.replace(/:{3,4}/,"::")}return o}function p(e){return e?e.toLowerCase():"ipv4"}function E(e,s){let n=e;const r=n>32?"ipv6":p(s);let f=4;if(r==="ipv6"){f=16}const t=h.Buffer.alloc(f);for(let o=0,i=t.length;o<i;++o){let l=8;if(n<8){l=n}n-=l;t[o]=~(255>>l)&255}return u(t)}function d(e,s){const n=a(e);const r=a(s);const f=h.Buffer.alloc(Math.max(n.length,r.length));let t=0;if(n.length===r.length){for(t=0;t<n.length;t++){f[t]=n[t]&r[t]}}else if(r.length===4){for(t=0;t<r.length;t++){f[t]=n[n.length-4+t]&r[t]}}else{for(t=0;t<f.length-6;t++){f[t]=0}f[10]=255;f[11]=255;for(t=0;t<n.length;t++){f[t+12]=n[t]&r[t+12]}t+=12}for(;t<f.length;t++)f[t]=0;return u(f)}function M(e){const s=e.split("/");const n=s[0];if(s.length!==2)throw new Error(`invalid CIDR subnet: ${n}`);const r=E(parseInt(s[1],10));return d(n,r)}function _(e){let s=0;e.split(".").forEach(n=>{s<<=8;s+=parseInt(n,10)});return s>>>0}function c(e){return`${e>>>24}.${e>>16&255}.${e>>8&255}.${e&255}`}function w(e,s){const n=_(d(e,s));const r=a(s);let f=0;for(let o=0;o<r.length;o++){if(r[o]===255){f+=8}else{let i=r[o]&255;while(i){i=i<<1&255;f++}}}const t=2**(32-f);return{networkAddress:c(n),firstAddress:t<=2?c(n):c(n+1),lastAddress:t<=2?c(n+t-1):c(n+t-2),broadcastAddress:c(n+t-1),subnetMask:s,subnetMaskLength:f,numHosts:t<=2?t:t-2,length:t,contains(o){return n===_(d(o,s))}}}function q(e){const s=e.split("/");const n=s[0];if(s.length!==2)throw new Error(`invalid CIDR subnet: ${n}`);const r=E(parseInt(s[1],10));return w(n,r)}function z(e){let s;const n=a(e);for(s=0;s<n.length;s++){n[s]=255^n[s]}return u(n)}function D(e,s){let n;const r=a(e);const f=a(s);if(r.length===f.length){for(n=0;n<r.length;++n){r[n]|=f[n]}return u(r)}let t=r;let o=f;if(f.length>r.length){t=f;o=r}const i=t.length-o.length;for(n=i;n<t.length;++n){t[n]|=o[n-i]}return u(t)}function O(e,s){let n;let r=a(e);let f=a(s);if(r.length===f.length){for(n=0;n<r.length;n++){if(r[n]!==f[n])return false}return true}if(f.length===4){const o=f;f=r;r=o}for(n=0;n<10;n++){if(f[n]!==0)return false}const t=f.readUInt16BE(10);if(t!==0&&t!==65535)return false;for(n=0;n<4;n++){if(r[n]!==f[n+12])return false}return true}function b(e){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)}function k(e){return!b(e)}function L(e){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^fe80::1$/.test(e)||/^::1$/.test(e)||/^::$/.test(e)}function y(e){const s=p(e);if(s!=="ipv4"&&s!=="ipv6"){throw new Error("family must be ipv4 or ipv6")}return s==="ipv4"?"127.0.0.1":"fe80::1"}function U(e,s){const n=m.networkInterfaces();const r=p(s);if(e&&e!=="private"&&e!=="public"){const t=n[e].filter(o=>{const i=o.family.toLowerCase();return i===r});if(t.length===0)return void 0;return t[0].address}const f=Object.keys(n).map(t=>{const o=n[t].filter(i=>{const l=i.family.toLowerCase();if(l!==r||L(i.address)){return false}if(!e){return true}return e==="public"?b(i.address):k(i.address)});return o.length?o[0].address:void 0}).filter(Boolean);return!f.length?y(r):f[0]}
